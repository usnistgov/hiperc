<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HiPerC: cuda_kernels.cuh File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HiPerC
   &#160;<span id="projectnumber">alpha</span>
   </div>
   <div id="projectbrief">High Performance Computing Strategies for Boundary Value Problems</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_335d7a46123208af85470a78bd5679d6.html">gpu-cuda-diffusion</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">cuda_kernels.cuh File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Declaration of functions to execute on the GPU (CUDA kernels)  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="numerics_8h_source.html">numerics.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for cuda_kernels.cuh:</div>
<div class="dyncontent">
<div class="center"><img src="cuda__kernels_8cuh__incl.png" border="0" usemap="#acuda__kernels_8cuh" alt=""/></div>
<map name="acuda__kernels_8cuh" id="acuda__kernels_8cuh">
<area shape="rect" title="Declaration of functions to execute on the GPU (CUDA kernels)" alt="" coords="5,5,128,32"/>
<area shape="rect" href="numerics_8h.html" title="Declaration of Laplacian operator and analytical solution functions." alt="" coords="24,80,109,107"/>
<area shape="rect" href="type_8h.html" title="Definition of scalar data type and Doxygen diffusion group." alt="" coords="39,155,95,181"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="cuda__kernels_8cuh__dep__incl.png" border="0" usemap="#acuda__kernels_8cuhdep" alt=""/></div>
<map name="acuda__kernels_8cuhdep" id="acuda__kernels_8cuhdep">
<area shape="rect" title="Declaration of functions to execute on the GPU (CUDA kernels)" alt="" coords="155,5,278,32"/>
<area shape="rect" href="cuda__boundaries_8cu.html" title="Implementation of boundary condition functions with OpenMP threading." alt="" coords="5,80,143,107"/>
<area shape="rect" href="cuda__data_8cu.html" title="Implementation of functions to create and destroy CudaData struct." alt="" coords="167,80,266,107"/>
<area shape="rect" href="cuda__discretization_8cu.html" title="Implementation of boundary condition functions with CUDA acceleration." alt="" coords="291,80,441,107"/>
</map>
</div>
</div>
<p><a href="cuda__kernels_8cuh_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9b5b126fb9ae9e22c7faea87a5b1e125"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cuda__kernels_8cuh.html#a9b5b126fb9ae9e22c7faea87a5b1e125">boundary_kernel</a> (<a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> *conc, const int nx, const int ny, const int nm)</td></tr>
<tr class="memdesc:a9b5b126fb9ae9e22c7faea87a5b1e125"><td class="mdescLeft">&#160;</td><td class="mdescRight">Boundary condition kernel for execution on the GPU.  <a href="cuda__kernels_8cuh.html#a9b5b126fb9ae9e22c7faea87a5b1e125">More...</a><br /></td></tr>
<tr class="separator:a9b5b126fb9ae9e22c7faea87a5b1e125"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac26a10c1f3a887212dec46fa6e822a24"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cuda__kernels_8cuh.html#ac26a10c1f3a887212dec46fa6e822a24">convolution_kernel</a> (<a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> *conc_old, <a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> *conc_lap, const int nx, const int ny, const int nm)</td></tr>
<tr class="memdesc:ac26a10c1f3a887212dec46fa6e822a24"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tiled convolution algorithm for execution on the GPU.  <a href="cuda__kernels_8cuh.html#ac26a10c1f3a887212dec46fa6e822a24">More...</a><br /></td></tr>
<tr class="separator:ac26a10c1f3a887212dec46fa6e822a24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a480a047f5eaad06dce39dca93d913fad"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cuda__kernels_8cuh.html#a480a047f5eaad06dce39dca93d913fad">diffusion_kernel</a> (<a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> *conc_old, <a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> *conc_new, <a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> *conc_lap, const int nx, const int ny, const int nm, const <a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> D, const <a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> dt)</td></tr>
<tr class="memdesc:a480a047f5eaad06dce39dca93d913fad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector addition algorithm for execution on the GPU.  <a href="cuda__kernels_8cuh.html#a480a047f5eaad06dce39dca93d913fad">More...</a><br /></td></tr>
<tr class="separator:a480a047f5eaad06dce39dca93d913fad"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:abe71c4e271ad2707c94a91c63656388b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cuda__kernels_8cuh.html#abe71c4e271ad2707c94a91c63656388b">d_mask</a> [5 *5]</td></tr>
<tr class="memdesc:abe71c4e271ad2707c94a91c63656388b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convolution mask array on the GPU, allocated in protected memory.  <a href="cuda__kernels_8cuh.html#abe71c4e271ad2707c94a91c63656388b">More...</a><br /></td></tr>
<tr class="separator:abe71c4e271ad2707c94a91c63656388b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Declaration of functions to execute on the GPU (CUDA kernels) </p>

<p class="definition">Definition in file <a class="el" href="cuda__kernels_8cuh_source.html">cuda_kernels.cuh</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a9b5b126fb9ae9e22c7faea87a5b1e125"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b5b126fb9ae9e22c7faea87a5b1e125">&#9670;&nbsp;</a></span>boundary_kernel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void boundary_kernel </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> *&#160;</td>
          <td class="paramname"><em>d_conc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Boundary condition kernel for execution on the GPU. </p>
<p>This function accesses 1D data rather than the 2D array representation of the scalar composition field</p>
<p>Boundary condition kernel for execution on the GPU.</p>
<p>Boundary condition kernel for execution on the GPU</p>
<p>This function accesses 1D data rather than the 2D array representation of the scalar composition field </p>

<p class="definition">Definition at line <a class="el" href="cuda__boundaries_8cu_source.html#l00041">41</a> of file <a class="el" href="cuda__boundaries_8cu_source.html">cuda_boundaries.cu</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cuda__kernels_8cuh_a9b5b126fb9ae9e22c7faea87a5b1e125_icgraph.png" border="0" usemap="#acuda__kernels_8cuh_a9b5b126fb9ae9e22c7faea87a5b1e125_icgraph" alt=""/></div>
<map name="acuda__kernels_8cuh_a9b5b126fb9ae9e22c7faea87a5b1e125_icgraph" id="acuda__kernels_8cuh_a9b5b126fb9ae9e22c7faea87a5b1e125_icgraph">
<area shape="rect" title="Boundary condition kernel for execution on the GPU." alt="" coords="104,5,220,32"/>
<area shape="rect" href="openacc__main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Run simulation using input parameters specified on the command line." alt="" coords="5,5,56,32"/>
</map>
</div>

</div>
</div>
<a id="ac26a10c1f3a887212dec46fa6e822a24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac26a10c1f3a887212dec46fa6e822a24">&#9670;&nbsp;</a></span>convolution_kernel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void convolution_kernel </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> *&#160;</td>
          <td class="paramname"><em>conc_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> *&#160;</td>
          <td class="paramname"><em>conc_lap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tiled convolution algorithm for execution on the GPU. </p>
<p>This function accesses 1D data rather than the 2D array representation of the scalar composition field, mapping into 2D tiles on the GPU with halo cells before computing the convolution.</p>
<p>Note:</p><ul>
<li>The source matrix (<em>conc_old</em>) and destination matrix (<em>conc_lap</em>) must be identical in size</li>
<li>One CUDA core operates on one array index: there is no nested loop over matrix elements</li>
<li>The halo (<em>nm/2</em> perimeter cells) in <em>conc_lap</em> are unallocated garbage</li>
<li>The same cells in <em>conc_old</em> are boundary values, and contribute to the convolution</li>
<li><em>conc_tile</em> is the shared tile of input data, accessible by all threads in this block </li>
</ul>

<p class="definition">Definition at line <a class="el" href="cuda__discretization_8cu_source.html#l00028">28</a> of file <a class="el" href="cuda__discretization_8cu_source.html">cuda_discretization.cu</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cuda__kernels_8cuh_ac26a10c1f3a887212dec46fa6e822a24_icgraph.png" border="0" usemap="#acuda__kernels_8cuh_ac26a10c1f3a887212dec46fa6e822a24_icgraph" alt=""/></div>
<map name="acuda__kernels_8cuh_ac26a10c1f3a887212dec46fa6e822a24_icgraph" id="acuda__kernels_8cuh_ac26a10c1f3a887212dec46fa6e822a24_icgraph">
<area shape="rect" title="Tiled convolution algorithm for execution on the GPU." alt="" coords="104,5,235,32"/>
<area shape="rect" href="openacc__main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Run simulation using input parameters specified on the command line." alt="" coords="5,5,56,32"/>
</map>
</div>

</div>
</div>
<a id="a480a047f5eaad06dce39dca93d913fad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a480a047f5eaad06dce39dca93d913fad">&#9670;&nbsp;</a></span>diffusion_kernel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void diffusion_kernel </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> *&#160;</td>
          <td class="paramname"><em>conc_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> *&#160;</td>
          <td class="paramname"><em>conc_new</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> *&#160;</td>
          <td class="paramname"><em>conc_lap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a>&#160;</td>
          <td class="paramname"><em>D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a>&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Vector addition algorithm for execution on the GPU. </p>
<p>This function accesses 1D data rather than the 2D array representation of the scalar composition field. Memory allocation, data transfer, and array release are handled in cuda_init(), with arrays on the host and device managed through <a class="el" href="structCudaData.html" title="Container for pointers to arrays on the GPU.">CudaData</a>, which is a struct passed by reference into the function. In this way, device kernels can be called in isolation without incurring the cost of data transfers and with reduced risk of memory leaks. </p>

<p class="definition">Definition at line <a class="el" href="cuda__discretization_8cu_source.html#l00085">85</a> of file <a class="el" href="cuda__discretization_8cu_source.html">cuda_discretization.cu</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cuda__kernels_8cuh_a480a047f5eaad06dce39dca93d913fad_icgraph.png" border="0" usemap="#acuda__kernels_8cuh_a480a047f5eaad06dce39dca93d913fad_icgraph" alt=""/></div>
<map name="acuda__kernels_8cuh_a480a047f5eaad06dce39dca93d913fad_icgraph" id="acuda__kernels_8cuh_a480a047f5eaad06dce39dca93d913fad_icgraph">
<area shape="rect" title="Vector addition algorithm for execution on the GPU." alt="" coords="104,5,216,32"/>
<area shape="rect" href="openacc__main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Run simulation using input parameters specified on the command line." alt="" coords="5,5,56,32"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="abe71c4e271ad2707c94a91c63656388b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe71c4e271ad2707c94a91c63656388b">&#9670;&nbsp;</a></span>d_mask</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> d_mask[5 * 5]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Convolution mask array on the GPU, allocated in protected memory. </p>

<p class="definition">Definition at line <a class="el" href="cuda__discretization_8cu_source.html#l00026">26</a> of file <a class="el" href="cuda__discretization_8cu_source.html">cuda_discretization.cu</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
