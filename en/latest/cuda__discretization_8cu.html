<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HiPerC: cuda_discretization.cu File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HiPerC
   &#160;<span id="projectnumber">alpha</span>
   </div>
   <div id="projectbrief">High Performance Computing Strategies for Boundary Value Problems</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_335d7a46123208af85470a78bd5679d6.html">gpu-cuda-diffusion</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">cuda_discretization.cu File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Implementation of boundary condition functions with CUDA acceleration.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &lt;omp.h&gt;</code><br />
<code>#include &lt;cuda.h&gt;</code><br />
<code>#include &quot;<a class="el" href="cuda__data_8h_source.html">cuda_data.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="boundaries_8h_source.html">boundaries.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="numerics_8h_source.html">numerics.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mesh_8h_source.html">mesh.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="timer_8h_source.html">timer.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="cuda__kernels_8cuh_source.html">cuda_kernels.cuh</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for cuda_discretization.cu:</div>
<div class="dyncontent">
<div class="center"><img src="cuda__discretization_8cu__incl.png" border="0" usemap="#acuda__discretization_8cu" alt=""/></div>
<map name="acuda__discretization_8cu" id="acuda__discretization_8cu">
<area shape="rect" title="Implementation of boundary condition functions with CUDA acceleration." alt="" coords="305,5,456,32"/>
<area shape="rect" title=" " alt="" coords="5,80,65,107"/>
<area shape="rect" title=" " alt="" coords="90,80,151,107"/>
<area shape="rect" title=" " alt="" coords="176,80,233,107"/>
<area shape="rect" title=" " alt="" coords="257,80,317,107"/>
<area shape="rect" href="cuda__data_8h.html" title="Declaration of CUDA data container." alt="" coords="243,155,335,181"/>
<area shape="rect" href="boundaries_8h.html" title="Declaration of boundary condition function prototypes." alt="" coords="359,155,453,181"/>
<area shape="rect" href="numerics_8h.html" title="Declaration of Laplacian operator and analytical solution functions." alt="" coords="566,155,651,181"/>
<area shape="rect" href="mesh_8h.html" title="Declaration of mesh function prototypes for diffusion benchmarks." alt="" coords="478,155,542,181"/>
<area shape="rect" href="timer_8h.html" title="Declaration of timer function prototypes for diffusion benchmarks." alt="" coords="545,80,606,107"/>
<area shape="rect" href="cuda__kernels_8cuh.html" title="Declaration of functions to execute on the GPU (CUDA kernels)" alt="" coords="630,80,753,107"/>
<area shape="rect" href="type_8h.html" title="Definition of scalar data type and Doxygen diffusion group." alt="" coords="430,229,486,256"/>
</map>
</div>
</div>
<p><a href="cuda__discretization_8cu_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7c7f6f8a38ce706ba12da6cb37edc306"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cuda__discretization_8cu.html#a7c7f6f8a38ce706ba12da6cb37edc306">convolution_kernel</a> (<a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> *d_conc_old, <a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> *d_conc_lap, const int nx, const int ny, const int nm)</td></tr>
<tr class="memdesc:a7c7f6f8a38ce706ba12da6cb37edc306"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tiled convolution algorithm for execution on the GPU.  <a href="cuda__discretization_8cu.html#a7c7f6f8a38ce706ba12da6cb37edc306">More...</a><br /></td></tr>
<tr class="separator:a7c7f6f8a38ce706ba12da6cb37edc306"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80eb3a042a574ed2b102a766626368a5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cuda__discretization_8cu.html#a80eb3a042a574ed2b102a766626368a5">diffusion_kernel</a> (<a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> *d_conc_old, <a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> *d_conc_new, <a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> *d_conc_lap, const int nx, const int ny, const int nm, const <a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> D, const <a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> dt)</td></tr>
<tr class="memdesc:a80eb3a042a574ed2b102a766626368a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector addition algorithm for execution on the GPU.  <a href="cuda__discretization_8cu.html#a80eb3a042a574ed2b102a766626368a5">More...</a><br /></td></tr>
<tr class="separator:a80eb3a042a574ed2b102a766626368a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b9329bb0d79a59dffa2c4ebbfdbb7fd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cuda__discretization_8cu.html#a0b9329bb0d79a59dffa2c4ebbfdbb7fd">device_boundaries</a> (<a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> *conc, const int nx, const int ny, const int nm, const int bx, const int by)</td></tr>
<tr class="memdesc:a0b9329bb0d79a59dffa2c4ebbfdbb7fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply boundary conditions on device.  <a href="cuda__discretization_8cu.html#a0b9329bb0d79a59dffa2c4ebbfdbb7fd">More...</a><br /></td></tr>
<tr class="separator:a0b9329bb0d79a59dffa2c4ebbfdbb7fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab39a6c102982d7c24e8c9fc68762be0e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cuda__discretization_8cu.html#ab39a6c102982d7c24e8c9fc68762be0e">device_convolution</a> (<a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> *conc_old, <a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> *conc_lap, const int nx, const int ny, const int nm, const int bx, const int by)</td></tr>
<tr class="memdesc:ab39a6c102982d7c24e8c9fc68762be0e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute convolution on device.  <a href="cuda__discretization_8cu.html#ab39a6c102982d7c24e8c9fc68762be0e">More...</a><br /></td></tr>
<tr class="separator:ab39a6c102982d7c24e8c9fc68762be0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1a32a0858f3583d4e6524aaab912f47"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cuda__discretization_8cu.html#af1a32a0858f3583d4e6524aaab912f47">device_composition</a> (<a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> *conc_old, <a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> *conc_new, <a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> *conc_lap, const int nx, const int ny, const int nm, const int bx, const int by, const <a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> D, const <a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> dt)</td></tr>
<tr class="memdesc:af1a32a0858f3583d4e6524aaab912f47"><td class="mdescLeft">&#160;</td><td class="mdescRight">Step diffusion equation on device.  <a href="cuda__discretization_8cu.html#af1a32a0858f3583d4e6524aaab912f47">More...</a><br /></td></tr>
<tr class="separator:af1a32a0858f3583d4e6524aaab912f47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeef5f0ae518af3a2b8f28a6600567f13"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cuda__discretization_8cu.html#aeef5f0ae518af3a2b8f28a6600567f13">read_out_result</a> (<a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> **conc, <a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> *d_conc, const int nx, const int ny)</td></tr>
<tr class="memdesc:aeef5f0ae518af3a2b8f28a6600567f13"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read data from device.  <a href="cuda__discretization_8cu.html#aeef5f0ae518af3a2b8f28a6600567f13">More...</a><br /></td></tr>
<tr class="separator:aeef5f0ae518af3a2b8f28a6600567f13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c30e00c6f4f45c1b2075cbb86f152dd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cuda__discretization_8cu.html#a1c30e00c6f4f45c1b2075cbb86f152dd">compute_convolution</a> (<a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> **conc_old, <a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> **conc_lap, <a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> **mask_lap, const int bx, const int by, const int nm, const int nx, const int ny)</td></tr>
<tr class="memdesc:a1c30e00c6f4f45c1b2075cbb86f152dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reference showing how to invoke the convolution kernel.  <a href="cuda__discretization_8cu.html#a1c30e00c6f4f45c1b2075cbb86f152dd">More...</a><br /></td></tr>
<tr class="separator:a1c30e00c6f4f45c1b2075cbb86f152dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af31dc39a15aeea9f35ea67eb945e83d1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cuda__discretization_8cu.html#af31dc39a15aeea9f35ea67eb945e83d1">cuda_diffusion_solver</a> (struct <a class="el" href="structCudaData.html">CudaData</a> *dev, <a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> **conc_new, const int bx, const int by, const int nm, const int nx, const int ny, const <a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> D, const <a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> dt, struct <a class="el" href="structStopwatch.html">Stopwatch</a> *sw)</td></tr>
<tr class="memdesc:af31dc39a15aeea9f35ea67eb945e83d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reference optimized code for solving the diffusion equation.  <a href="cuda__discretization_8cu.html#af31dc39a15aeea9f35ea67eb945e83d1">More...</a><br /></td></tr>
<tr class="separator:af31dc39a15aeea9f35ea67eb945e83d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:abe71c4e271ad2707c94a91c63656388b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cuda__discretization_8cu.html#abe71c4e271ad2707c94a91c63656388b">d_mask</a> [5 *5]</td></tr>
<tr class="memdesc:abe71c4e271ad2707c94a91c63656388b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convolution mask array on the GPU, allocated in protected memory.  <a href="cuda__discretization_8cu.html#abe71c4e271ad2707c94a91c63656388b">More...</a><br /></td></tr>
<tr class="separator:abe71c4e271ad2707c94a91c63656388b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implementation of boundary condition functions with CUDA acceleration. </p>

<p class="definition">Definition in file <a class="el" href="cuda__discretization_8cu_source.html">cuda_discretization.cu</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a1c30e00c6f4f45c1b2075cbb86f152dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c30e00c6f4f45c1b2075cbb86f152dd">&#9670;&nbsp;</a></span>compute_convolution()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void compute_convolution </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> **&#160;</td>
          <td class="paramname"><em>conc_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> **&#160;</td>
          <td class="paramname"><em>conc_lap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> **&#160;</td>
          <td class="paramname"><em>mask_lap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>bx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>by</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ny</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reference showing how to invoke the convolution kernel. </p>
<p>A stand-alone function like this incurs the cost of host-to-device data transfer each time it is called: it is a teaching tool, not reusable code. It is the basis for <a class="el" href="cuda__discretization_8cu.html#af31dc39a15aeea9f35ea67eb945e83d1" title="Reference optimized code for solving the diffusion equation.">cuda_diffusion_solver()</a>, which achieves much better performance by bundling CUDA kernels together and intelligently managing data transfers between the host (CPU) and device (GPU). </p>

<p class="definition">Definition at line <a class="el" href="cuda__discretization_8cu_source.html#l00170">170</a> of file <a class="el" href="cuda__discretization_8cu_source.html">cuda_discretization.cu</a>.</p>

</div>
</div>
<a id="a7c7f6f8a38ce706ba12da6cb37edc306"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c7f6f8a38ce706ba12da6cb37edc306">&#9670;&nbsp;</a></span>convolution_kernel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void convolution_kernel </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> *&#160;</td>
          <td class="paramname"><em>conc_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> *&#160;</td>
          <td class="paramname"><em>conc_lap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tiled convolution algorithm for execution on the GPU. </p>
<p>This function accesses 1D data rather than the 2D array representation of the scalar composition field, mapping into 2D tiles on the GPU with halo cells before computing the convolution.</p>
<p>Note:</p><ul>
<li>The source matrix (<em>conc_old</em>) and destination matrix (<em>conc_lap</em>) must be identical in size</li>
<li>One CUDA core operates on one array index: there is no nested loop over matrix elements</li>
<li>The halo (<em>nm/2</em> perimeter cells) in <em>conc_lap</em> are unallocated garbage</li>
<li>The same cells in <em>conc_old</em> are boundary values, and contribute to the convolution</li>
<li><em>conc_tile</em> is the shared tile of input data, accessible by all threads in this block </li>
</ul>

<p class="definition">Definition at line <a class="el" href="cuda__discretization_8cu_source.html#l00028">28</a> of file <a class="el" href="cuda__discretization_8cu_source.html">cuda_discretization.cu</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cuda__discretization_8cu_a7c7f6f8a38ce706ba12da6cb37edc306_icgraph.png" border="0" usemap="#acuda__discretization_8cu_a7c7f6f8a38ce706ba12da6cb37edc306_icgraph" alt=""/></div>
<map name="acuda__discretization_8cu_a7c7f6f8a38ce706ba12da6cb37edc306_icgraph" id="acuda__discretization_8cu_a7c7f6f8a38ce706ba12da6cb37edc306_icgraph">
<area shape="rect" title="Tiled convolution algorithm for execution on the GPU." alt="" coords="104,5,235,32"/>
<area shape="rect" href="openacc__main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Run simulation using input parameters specified on the command line." alt="" coords="5,5,56,32"/>
</map>
</div>

</div>
</div>
<a id="af31dc39a15aeea9f35ea67eb945e83d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af31dc39a15aeea9f35ea67eb945e83d1">&#9670;&nbsp;</a></span>cuda_diffusion_solver()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cuda_diffusion_solver </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structCudaData.html">CudaData</a> *&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> **&#160;</td>
          <td class="paramname"><em>conc_new</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>bx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>by</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a>&#160;</td>
          <td class="paramname"><em>D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a>&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structStopwatch.html">Stopwatch</a> *&#160;</td>
          <td class="paramname"><em>sw</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reference optimized code for solving the diffusion equation. </p>
<p>Solve diffusion equation on the GPU.</p>
<p>Compare <a class="el" href="cuda__data_8h.html#af31dc39a15aeea9f35ea67eb945e83d1" title="Solve diffusion equation on the GPU.">cuda_diffusion_solver()</a>: it accomplishes the same result, but without the memory allocation, data transfer, and array release. These are handled in cuda_init(), with arrays on the host and device managed through <a class="el" href="structCudaData.html" title="Container for pointers to arrays on the GPU.">CudaData</a>, which is a struct passed by reference into the function. In this way, device kernels can be called in isolation without incurring the cost of data transfers and with reduced risk of memory leaks. </p>

<p class="definition">Definition at line <a class="el" href="cuda__discretization_8cu_source.html#l00219">219</a> of file <a class="el" href="cuda__discretization_8cu_source.html">cuda_discretization.cu</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cuda__discretization_8cu_af31dc39a15aeea9f35ea67eb945e83d1_cgraph.png" border="0" usemap="#acuda__discretization_8cu_af31dc39a15aeea9f35ea67eb945e83d1_cgraph" alt=""/></div>
<map name="acuda__discretization_8cu_af31dc39a15aeea9f35ea67eb945e83d1_cgraph" id="acuda__discretization_8cu_af31dc39a15aeea9f35ea67eb945e83d1_cgraph">
<area shape="rect" title="Reference optimized code for solving the diffusion equation." alt="" coords="5,5,152,32"/>
<area shape="rect" href="timer_8c.html#ab9a9e5a3142f8bbd781192e032d74c66" title="Return elapsed time in seconds." alt="" coords="200,5,276,32"/>
</map>
</div>

</div>
</div>
<a id="a0b9329bb0d79a59dffa2c4ebbfdbb7fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b9329bb0d79a59dffa2c4ebbfdbb7fd">&#9670;&nbsp;</a></span>device_boundaries()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void device_boundaries </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> *&#160;</td>
          <td class="paramname"><em>conc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>bx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>by</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply boundary conditions on device. </p>

<p class="definition">Definition at line <a class="el" href="cuda__discretization_8cu_source.html#l00108">108</a> of file <a class="el" href="cuda__discretization_8cu_source.html">cuda_discretization.cu</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cuda__discretization_8cu_a0b9329bb0d79a59dffa2c4ebbfdbb7fd_icgraph.png" border="0" usemap="#acuda__discretization_8cu_a0b9329bb0d79a59dffa2c4ebbfdbb7fd_icgraph" alt=""/></div>
<map name="acuda__discretization_8cu_a0b9329bb0d79a59dffa2c4ebbfdbb7fd_icgraph" id="acuda__discretization_8cu_a0b9329bb0d79a59dffa2c4ebbfdbb7fd_icgraph">
<area shape="rect" title="Apply boundary conditions on device." alt="" coords="104,5,235,32"/>
<area shape="rect" href="cuda__main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Run simulation using input parameters specified on the command line." alt="" coords="5,5,56,32"/>
</map>
</div>

</div>
</div>
<a id="af1a32a0858f3583d4e6524aaab912f47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1a32a0858f3583d4e6524aaab912f47">&#9670;&nbsp;</a></span>device_composition()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void device_composition </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> *&#160;</td>
          <td class="paramname"><em>conc_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> *&#160;</td>
          <td class="paramname"><em>conc_new</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> *&#160;</td>
          <td class="paramname"><em>conc_lap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>bx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>by</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a>&#160;</td>
          <td class="paramname"><em>D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a>&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Step diffusion equation on device. </p>

<p class="definition">Definition at line <a class="el" href="cuda__discretization_8cu_source.html#l00140">140</a> of file <a class="el" href="cuda__discretization_8cu_source.html">cuda_discretization.cu</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cuda__discretization_8cu_af1a32a0858f3583d4e6524aaab912f47_icgraph.png" border="0" usemap="#acuda__discretization_8cu_af1a32a0858f3583d4e6524aaab912f47_icgraph" alt=""/></div>
<map name="acuda__discretization_8cu_af1a32a0858f3583d4e6524aaab912f47_icgraph" id="acuda__discretization_8cu_af1a32a0858f3583d4e6524aaab912f47_icgraph">
<area shape="rect" title="Step diffusion equation on device." alt="" coords="104,5,241,32"/>
<area shape="rect" href="cuda__main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Run simulation using input parameters specified on the command line." alt="" coords="5,5,56,32"/>
</map>
</div>

</div>
</div>
<a id="ab39a6c102982d7c24e8c9fc68762be0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab39a6c102982d7c24e8c9fc68762be0e">&#9670;&nbsp;</a></span>device_convolution()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void device_convolution </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> *&#160;</td>
          <td class="paramname"><em>conc_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> *&#160;</td>
          <td class="paramname"><em>conc_lap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>bx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>by</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute convolution on device. </p>

<p class="definition">Definition at line <a class="el" href="cuda__discretization_8cu_source.html#l00123">123</a> of file <a class="el" href="cuda__discretization_8cu_source.html">cuda_discretization.cu</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cuda__discretization_8cu_ab39a6c102982d7c24e8c9fc68762be0e_icgraph.png" border="0" usemap="#acuda__discretization_8cu_ab39a6c102982d7c24e8c9fc68762be0e_icgraph" alt=""/></div>
<map name="acuda__discretization_8cu_ab39a6c102982d7c24e8c9fc68762be0e_icgraph" id="acuda__discretization_8cu_ab39a6c102982d7c24e8c9fc68762be0e_icgraph">
<area shape="rect" title="Compute convolution on device." alt="" coords="104,5,237,32"/>
<area shape="rect" href="cuda__main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Run simulation using input parameters specified on the command line." alt="" coords="5,5,56,32"/>
</map>
</div>

</div>
</div>
<a id="a80eb3a042a574ed2b102a766626368a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80eb3a042a574ed2b102a766626368a5">&#9670;&nbsp;</a></span>diffusion_kernel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void diffusion_kernel </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> *&#160;</td>
          <td class="paramname"><em>conc_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> *&#160;</td>
          <td class="paramname"><em>conc_new</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> *&#160;</td>
          <td class="paramname"><em>conc_lap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a>&#160;</td>
          <td class="paramname"><em>D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a>&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Vector addition algorithm for execution on the GPU. </p>
<p>This function accesses 1D data rather than the 2D array representation of the scalar composition field. Memory allocation, data transfer, and array release are handled in cuda_init(), with arrays on the host and device managed through <a class="el" href="structCudaData.html" title="Container for pointers to arrays on the GPU.">CudaData</a>, which is a struct passed by reference into the function. In this way, device kernels can be called in isolation without incurring the cost of data transfers and with reduced risk of memory leaks. </p>

<p class="definition">Definition at line <a class="el" href="cuda__discretization_8cu_source.html#l00085">85</a> of file <a class="el" href="cuda__discretization_8cu_source.html">cuda_discretization.cu</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cuda__discretization_8cu_a80eb3a042a574ed2b102a766626368a5_icgraph.png" border="0" usemap="#acuda__discretization_8cu_a80eb3a042a574ed2b102a766626368a5_icgraph" alt=""/></div>
<map name="acuda__discretization_8cu_a80eb3a042a574ed2b102a766626368a5_icgraph" id="acuda__discretization_8cu_a80eb3a042a574ed2b102a766626368a5_icgraph">
<area shape="rect" title="Vector addition algorithm for execution on the GPU." alt="" coords="104,5,216,32"/>
<area shape="rect" href="openacc__main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Run simulation using input parameters specified on the command line." alt="" coords="5,5,56,32"/>
</map>
</div>

</div>
</div>
<a id="aeef5f0ae518af3a2b8f28a6600567f13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeef5f0ae518af3a2b8f28a6600567f13">&#9670;&nbsp;</a></span>read_out_result()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_out_result </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> **&#160;</td>
          <td class="paramname"><em>conc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> *&#160;</td>
          <td class="paramname"><em>d_conc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ny</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read data from device. </p>

<p class="definition">Definition at line <a class="el" href="cuda__discretization_8cu_source.html#l00155">155</a> of file <a class="el" href="cuda__discretization_8cu_source.html">cuda_discretization.cu</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cuda__discretization_8cu_aeef5f0ae518af3a2b8f28a6600567f13_icgraph.png" border="0" usemap="#acuda__discretization_8cu_aeef5f0ae518af3a2b8f28a6600567f13_icgraph" alt=""/></div>
<map name="acuda__discretization_8cu_aeef5f0ae518af3a2b8f28a6600567f13_icgraph" id="acuda__discretization_8cu_aeef5f0ae518af3a2b8f28a6600567f13_icgraph">
<area shape="rect" title="Read data from device." alt="" coords="104,5,215,32"/>
<area shape="rect" href="cuda__main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Run simulation using input parameters specified on the command line." alt="" coords="5,5,56,32"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="abe71c4e271ad2707c94a91c63656388b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe71c4e271ad2707c94a91c63656388b">&#9670;&nbsp;</a></span>d_mask</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="type_8h.html#ab25cc4c4d0a09d9da9582fdcfc6185b5">fp_t</a> d_mask[5 * 5]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convolution mask array on the GPU, allocated in protected memory. </p>

<p class="definition">Definition at line <a class="el" href="cuda__discretization_8cu_source.html#l00026">26</a> of file <a class="el" href="cuda__discretization_8cu_source.html">cuda_discretization.cu</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
